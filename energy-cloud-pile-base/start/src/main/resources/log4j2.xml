<?xml version="1.0" encoding="UTF-8"?>
<!--日志级别以及优先级排序: OFF > FATAL > ERROR > WARN > INFO > DEBUG > TRACE > ALL -->
<!--status="WARN" :用于设置log4j2自身内部日志的信息输出级别，默认是OFF-->
<!--monitorInterval="30"  :间隔秒数,自动检测配置文件的变更和重新配置本身-->
<Configuration status="WARN" monitorInterval="60">
    <!--自定义一些常量，之后使用${变量名}引用-->
    <properties>
        <property name="LOG_HOME">/data/logs/${env:HOSTNAME}/</property>
        <property name="DEBUG_NAME">debug</property>
        <property name="INFO_NAME">info</property>
        <property name="WARN_NAME">warn</property>
        <property name="ERROR_NAME">error</property>
        <property name="charset">UTF-8</property>
        <Property name="pattern">%d{yyyy-MM-dd HH:mm:ss.SSS}--[%traceId]--[%X{ThreadContextId}]-- [%thread] %-5level %logger{36} %line - %msg%n%ex</Property>
    </properties>
    <Appenders>
        <Console name="Console" target="SYSTEM_OUT">
            <ThresholdFilter level="trace" onMatch="ACCEPT" onMismatch="DENY"/>
            <PatternLayout pattern="${pattern}"/>
        </Console>
        <RollingRandomAccessFile name="DebugFile" immediateFlush="true" bufferSize="2048"
                                 fileName="${LOG_HOME}/${DEBUG_NAME}.log"
                                 filePattern="${LOG_HOME}/$${date:yyyy-MM}/${DEBUG_NAME}-%d{yyyy-MM-dd-HH-mm}-%i.log">
            <PatternLayout pattern="${pattern}"/>
            <!--
                在warn及以上的级别都不打印，其他的不做处理 > WARN\ERROR\FATAL被过滤删除 只剩TRACE\DEBUG\INFO
                在info及以上的都打印，其他的不打印 > RACE\DEBUG被过滤删除 只剩下info被打印
                所以要注意Filter的执行顺序
                -->
            <Filters>
                <!--
                在warn及以上的级别都不打印，其他的不做处理 > WARN\ERROR\FATAL被过滤删除 只剩TRACE\DEBUG\INFO
                在info及以上的都打印，其他的不打印 > RACE\DEBUG被过滤删除 只剩下info被打印
                所以要注意Filter的执行顺序
                -->
                <ThresholdFilter level="info" onMatch="DENY" onMismatch="NEUTRAL"/>
                <ThresholdFilter level="debug" onMatch="ACCEPT" onMismatch="DENY"/>
            </Filters>
            <!-- Policies :日志滚动策略-->
            <Policies>
                <TimeBasedTriggeringPolicy interval="1"/>
                <SizeBasedTriggeringPolicy size="20 MB"/>
            </Policies>
            <DefaultRolloverStrategy max="10"/>
        </RollingRandomAccessFile>
        <RollingRandomAccessFile name="InfoFile" immediateFlush="true" bufferSize="2048"
                                 fileName="${LOG_HOME}/${INFO_NAME}.log"
                                 filePattern="${LOG_HOME}/$${date:yyyy-MM}/${INFO_NAME}-%d{yyyy-MM-dd-HH-mm}-%i.log">
            <PatternLayout pattern="${pattern}"/>
            <Filters>
                <ThresholdFilter level="warn" onMatch="DENY" onMismatch="ACCEPT"/>
                <ThresholdFilter level="info" onMatch="ACCEPT" onMismatch="DENY"/>
            </Filters>
            <Policies>
                <TimeBasedTriggeringPolicy interval="1"/>
                <SizeBasedTriggeringPolicy size="10 MB"/>
            </Policies>
            <DefaultRolloverStrategy max="30"/>
        </RollingRandomAccessFile>
        <RollingRandomAccessFile name="WarnFile" immediateFlush="true" bufferSize="2048"
                                 fileName="${LOG_HOME}/${WARN_NAME}.log"
                                 filePattern="${LOG_HOME}/$${date:yyyy-MM}/${INFO_NAME}-%d{yyyy-MM-dd-HH-mm}-%i.log">
            <PatternLayout pattern="${pattern}"/>
            <Filters>
                <ThresholdFilter level="error" onMatch="DENY" onMismatch="ACCEPT"/>
                <ThresholdFilter level="warn" onMatch="ACCEPT" onMismatch="DENY"/>
            </Filters>
            <Policies>
                <TimeBasedTriggeringPolicy interval="1"/>
                <SizeBasedTriggeringPolicy size="10 MB"/>
            </Policies>
            <DefaultRolloverStrategy max="30"/>
        </RollingRandomAccessFile>
        <RollingRandomAccessFile name="ErrorFile" immediateFlush="true" bufferSize="2048"
                                 fileName="${LOG_HOME}/${ERROR_NAME}.log"
                                 filePattern="${LOG_HOME}/$${date:yyyy-MM}/${ERROR_NAME}-%d{yyyy-MM-dd-HH-mm}-%i.log">
            <PatternLayout pattern="${pattern}"/>
            <Filters>
                <ThresholdFilter level="error" onMatch="ACCEPT" onMismatch="DENY"/>
            </Filters>
            <Policies>
                <TimeBasedTriggeringPolicy interval="1"/>
                <SizeBasedTriggeringPolicy size="10 MB"/>
            </Policies>
            <DefaultRolloverStrategy max="20"/>
        </RollingRandomAccessFile>
    </Appenders>

    <Loggers>
        <Logger name="org.elasticsearch.client.RestClient" level="ERROR"/>
        <Logger name="org.apache.kafka.clients.NetworkClient" level="ERROR"/>
        <Logger additivity="false" name="org.apache.ibatis.logging.stdout.StdOutImpl"  level="info"  includeLocation="false">
            <AppenderRef ref="Console" level="INFO"/>
            <AppenderRef ref="DebugFile" level="DEBUG"/>
            <AppenderRef ref="InfoFile" level="INFO"/>
            <AppenderRef ref="WarnFile" level="WARN"/>
            <AppenderRef ref="ErrorFile" level="ERROR"/>
        </Logger>
        <Root level="all">
            <AppenderRef ref="Console" level="INFO"/>
            <AppenderRef ref="DebugFile" level="DEBUG"/>
            <AppenderRef ref="InfoFile" level="INFO"/>
            <AppenderRef ref="WarnFile" level="WARN"/>
            <AppenderRef ref="ErrorFile" level="ERROR"/>
        </Root>
    </Loggers>
</Configuration>